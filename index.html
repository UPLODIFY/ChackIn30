<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CheckIn30 - Daily Rewards</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
    <style>
        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #4cc9f0;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --dark: #0f0c29;
            --light: #f8f9fa;
            --gray: #6c757d;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Header */
        .main-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(15, 12, 41, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Poppins', sans-serif;
            font-size: 1.8rem;
            font-weight: 800;
            color: white;
            text-decoration: none;
        }

        .logo i {
            color: var(--accent);
        }

        .header-auth {
            display: flex;
            gap: 15px;
        }

        .header-btn {
            padding: 8px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-size: 0.9rem;
        }

        .login-btn {
            background: transparent;
            color: var(--accent);
            border: 2px solid var(--accent);
        }

        .login-btn:hover {
            background: var(--accent);
            color: white;
        }

        .register-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .register-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent), var(--primary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-avatar i {
            color: white;
        }

        .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .user-points {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .logout-btn {
            background: transparent;
            border: 2px solid var(--danger);
            color: var(--danger);
            padding: 8px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: var(--danger);
            color: white;
        }

        /* Main Content */
        .main-content {
            padding-top: 80px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Hero Section */
        .hero-section {
            padding: 60px 20px;
            text-align: center;
            background: linear-gradient(135deg, rgba(67, 97, 238, 0.1), rgba(58, 12, 163, 0.1));
            border-radius: 20px;
            margin: 20px;
            animation: fadeIn 1s ease;
        }

        .hero-title {
            font-family: 'Poppins', sans-serif;
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 20px;
            background: linear-gradient(45deg, var(--accent), white);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: slideUp 1s ease;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            animation: slideUp 1.2s ease;
        }

        /* Stats Section */
        .stats-section {
            padding: 40px 20px;
            animation: fadeIn 1.4s ease;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
            animation: fadeIn 0.6s ease;
        }

        .stat-item:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
        }

        .stat-item i {
            font-size: 2.5rem;
            color: var(--accent);
            margin-bottom: 15px;
        }

        .stat-item h3 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: white;
        }

        .stat-item p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        /* Progress Bar */
        .progress-container {
            margin: 30px 0;
            animation: fadeIn 1.6s ease;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.8);
        }

        .progress-bar {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--primary));
            border-radius: 10px;
            width: 0%;
            transition: width 1s ease;
            position: relative;
        }

        .progress-days {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
        }

        .day-marker {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .day-marker.active {
            background: var(--success);
            color: white;
            transform: scale(1.1);
        }

        .day-marker.completed {
            background: var(--accent);
            color: white;
        }

        /* Features Section */
        .features-section {
            padding: 60px 20px;
            animation: fadeIn 1.8s ease;
        }

        .section-title {
            font-family: 'Poppins', sans-serif;
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 50px;
            color: white;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, var(--accent), var(--primary));
            border-radius: 2px;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            animation: fadeIn 0.8s ease;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .feature-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .feature-icon i {
            font-size: 2rem;
            color: white;
        }

        .feature-card h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: white;
        }

        .feature-card p {
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.6;
            margin-bottom: 20px;
        }

        /* Ads Section */
        .ads-section {
            padding: 40px 20px;
            animation: fadeIn 2s ease;
        }

        .ad-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin: 20px 0;
        }

        /* Footer */
        .main-footer {
            background: rgba(15, 12, 41, 0.95);
            padding: 60px 20px 30px;
            margin-top: 60px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
        }

        .footer-section h3 {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: white;
        }

        .footer-section p {
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 10px;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: var(--accent);
        }

        .copyright {
            text-align: center;
            padding-top: 30px;
            margin-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9rem;
        }

        /* Modals */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: rgba(15, 12, 41, 0.95);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: slideUp 0.4s ease;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-header h3 {
            font-size: 1.8rem;
            color: var(--accent);
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
        }

        .modal-timer {
            text-align: center;
            margin: 30px 0;
            font-size: 2.5rem;
            color: var(--accent);
            font-weight: bold;
        }

        .modal-progress {
            margin: 20px 0;
        }

        .modal-progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .modal-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--primary));
            border-radius: 5px;
            width: 0%;
            transition: width 1s linear;
        }

        .modal-progress-text {
            display: flex;
            justify-content: space-between;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .modal-ad {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
            border: 1px dashed rgba(255, 255, 255, 0.2);
        }

        .modal-ad h4 {
            margin-bottom: 10px;
            color: white;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .modal-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .modal-btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .modal-btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
        }

        .modal-btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .modal-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            font-size: 1rem;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .error-message {
            color: var(--danger);
            font-size: 0.9rem;
            margin-top: 5px;
            text-align: center;
            min-height: 20px;
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 100px;
            right: 20px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 3000;
            animation: slideInRight 0.3s ease;
            display: none;
            max-width: 300px;
        }

        .toast.active {
            display: block;
        }

        /* Check-in Button */
        .checkin-btn {
            background: linear-gradient(135deg, var(--accent), var(--primary));
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 30px auto;
            animation: pulse 2s infinite;
        }

        .checkin-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(76, 201, 240, 0.3);
        }

        .checkin-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            animation: none;
        }

        /* Request Button */
        .request-btn {
            background: linear-gradient(135deg, var(--success), #27ae60);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px auto;
        }

        .request-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }

        .request-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Request Status */
        .request-status {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent);
        }

        .request-status h4 {
            color: white;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .request-status p {
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.5;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Responsive */
        @media (max-width: 992px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="header-content">
            <a href="#" class="logo">
                <i class="fas fa-calendar-check"></i>
                <span>CheckIn30</span>
            </a>
            
            <div id="auth-buttons" class="header-auth">
                <button class="header-btn login-btn" onclick="openLoginModal()">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <button class="header-btn register-btn" onclick="openRegisterModal()">
                    <i class="fas fa-user-plus"></i> Register
                </button>
            </div>
            
            <div id="user-menu" class="user-info" style="display: none;">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-details">
                    <span class="user-name" id="header-username">User</span>
                    <span class="user-points">
                        <i class="fas fa-coins"></i>
                        <span id="header-points">0</span> Points
                    </span>
                </div>
                <button class="logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content" id="main-content" style="display: none;">
        <!-- Hero Section -->
        <section class="hero-section">
            <h1 class="hero-title">Welcome to CheckIn30</h1>
            <p class="hero-subtitle">Complete daily check-ins for 30 days and earn amazing rewards. Simple, secure, and rewarding!</p>
            
            <div class="progress-container">
                <div class="progress-header">
                    <span>30-Day Progress</span>
                    <span id="progress-percent">0%</span>
                </div>
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <div class="progress-days" id="progress-days">
                    <!-- Days will be added dynamically -->
                </div>
            </div>
            
            <button id="checkin-button" class="checkin-btn" onclick="openCheckinModal()" disabled>
                <i class="fas fa-lock"></i>
                <span id="checkin-text">Daily Check-in Locked</span>
            </button>
        </section>

        <!-- Stats Section -->
        <section class="stats-section">
            <div class="stats-grid">
                <div class="stat-item">
                    <i class="fas fa-fire"></i>
                    <h3 id="current-streak">0</h3>
                    <p>Current Streak</p>
                </div>
                <div class="stat-item">
                    <i class="fas fa-calendar-check"></i>
                    <h3 id="active-days">0</h3>
                    <p>Active Days</p>
                </div>
                <div class="stat-item">
                    <i class="fas fa-coins"></i>
                    <h3 id="total-points">0</h3>
                    <p>Total Points</p>
                </div>
                <div class="stat-item">
                    <i class="fas fa-gift"></i>
                    <h3 id="days-remaining">30</h3>
                    <p>Days Remaining</p>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features-section">
            <h2 class="section-title">How It Works</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <h3>Daily Visit</h3>
                    <p>Visit our website daily and browse for 2 minutes to unlock check-in.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3>Complete Check-in</h3>
                    <p>After 2 minutes, complete your daily check-in to earn points.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3>Track Progress</h3>
                    <p>Monitor your 30-day progress streak and active days.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <h3>Claim Reward</h3>
                    <p>After 30 days, request your reward which will be delivered in 3 days.</p>
                </div>
            </div>
        </section>

        <!-- Ads Section -->
        <section class="ads-section">
            <div class="ad-container">
                <!-- Main Home Banner Ad -->
                <script> 
                    atOptions = { 
                        'key' : '77505fdc9e6831daaf1eca8467e91c3c', 
                        'format' : 'iframe', 
                        'height' : 90, 
                        'width' : 728, 
                        'params' : {} 
                    }; 
                </script> 
                <script src="https://www.highperformanceformat.com/77505fdc9e6831daaf1eca8467e91c3c/invoke.js"></script>
            </div>
        </section>

        <!-- Request Status Section -->
        <div id="request-status-section" style="display: none;">
            <div class="request-status">
                <h4><i class="fas fa-hourglass-half"></i> Reward Request Status</h4>
                <p id="request-status-text">Your reward request has been submitted. It will be processed within 3 days.</p>
                <p id="request-date" style="font-size: 0.9rem; color: rgba(255, 255, 255, 0.5);"></p>
            </div>
        </div>

        <!-- More Features -->
        <section class="features-section">
            <h2 class="section-title">Why Choose CheckIn30?</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>Secure Platform</h3>
                    <p>Your data and earnings are protected with advanced security measures.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <h3>Instant Updates</h3>
                    <p>Real-time tracking of your progress and earnings.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-headset"></i>
                    </div>
                    <h3>24/7 Support</h3>
                    <p>Our support team is always ready to help you with any queries.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <h3>Mobile Friendly</h3>
                    <p>Access your account and complete check-ins from any device.</p>
                </div>
            </div>
        </section>

        <!-- Another Ad -->
        <section class="ads-section">
            <div class="ad-container">
                <!-- Native Ad -->
                <script async="async" data-cfasync="false" src="https://pl28624266.effectivegatecpm.com/6bc4ee56d47d8bd07693b3f7aff17fd1/invoke.js"></script> 
                <div id="container-6bc4ee56d47d8bd07693b3f7aff17fd1"></div>
            </div>
        </section>

        <!-- Referral Section -->
        <section class="features-section">
            <h2 class="section-title">Refer & Earn More</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <h3>Share Your Code</h3>
                    <p>Share your unique referral code with friends and family.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <h3>Earn Bonus Points</h3>
                    <p>Get +5 points for each friend who completes 3 check-ins.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3>Monthly Limits</h3>
                    <p>Earn from up to 5 referrals per month (safe & limited).</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <h3>Track Earnings</h3>
                    <p>Monitor your referral earnings and monthly progress.</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>CheckIn30</h3>
                <p>Daily check-ins for consistent rewards. Complete 30 days and claim your reward.</p>
                <p>Trusted by thousands of users worldwide.</p>
            </div>
            
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="#"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#"><i class="fas fa-gift"></i> Rewards</a></li>
                    <li><a href="#"><i class="fas fa-users"></i> Referral</a></li>
                    <li><a href="#"><i class="fas fa-question-circle"></i> FAQ</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Contact Support</h3>
                <p>Need help? Contact our support team:</p>
                <p><i class="fas fa-envelope"></i> gotmprajapat00@gmail.com</p>
                <p><i class="fas fa-clock"></i> 24/7 Support Available</p>
            </div>
        </div>
        
        <div class="copyright">
            <p>Â© 2024 CheckIn30. All rights reserved. | Daily Rewards Platform</p>
        </div>
    </footer>

    <!-- Modals -->

    <!-- Login Modal -->
    <div id="login-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-sign-in-alt"></i> Login</h3>
                <button class="modal-close" onclick="closeLoginModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="login-email">Email Address</label>
                    <input type="email" id="login-email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" placeholder="Enter your password">
                </div>
                <div id="login-error" class="error-message"></div>
                <div class="modal-buttons">
                    <button class="modal-btn modal-btn-primary" onclick="handleLogin()">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    <button class="modal-btn modal-btn-secondary" onclick="closeLoginModal()">
                        Cancel
                    </button>
                </div>
                <div class="modal-ad" style="margin-top: 20px;">
                    <h4>Special Offer!</h4>
                    <p>New users get bonus points on first check-in</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="register-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus"></i> Register</h3>
                <button class="modal-close" onclick="closeRegisterModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="register-email">Email Address</label>
                    <input type="email" id="register-email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="register-password">Password</label>
                    <input type="password" id="register-password" placeholder="Minimum 6 characters">
                </div>
                <div class="form-group">
                    <label for="register-referral">Referral Code (Optional)</label>
                    <input type="text" id="register-referral" placeholder="Enter friend's referral code">
                </div>
                <div id="register-error" class="error-message"></div>
                <div class="modal-buttons">
                    <button class="modal-btn modal-btn-primary" onclick="handleRegister()">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                    <button class="modal-btn modal-btn-secondary" onclick="closeRegisterModal()">
                        Cancel
                    </button>
                </div>
                <div class="modal-ad" style="margin-top: 20px;">
                    <h4>Start Earning Today!</h4>
                    <p>Complete your first check-in and earn bonus points</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Welcome/Timer Modal -->
    <div id="welcome-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-hourglass-start"></i> Daily Timer</h3>
                <button class="modal-close" onclick="closeWelcomeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>Please browse our website for 2 minutes to unlock daily check-in.</p>
                <p style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem;">
                    <i class="fas fa-info-circle"></i> Move mouse or scroll to keep timer active
                </p>
                
                <div class="modal-timer" id="welcome-timer">2:00</div>
                
                <div class="modal-progress">
                    <div class="modal-progress-bar">
                        <div id="welcome-progress-fill" class="modal-progress-fill"></div>
                    </div>
                    <div class="modal-progress-text">
                        <span>Time Spent:</span>
                        <span id="welcome-time-spent">0:00</span>
                    </div>
                </div>
                
                <div class="modal-ad">
                    <h4>Limited Time Offer!</h4>
                    <p>Check our special offers while you wait</p>
                </div>
                
                <button class="modal-btn modal-btn-primary" onclick="closeWelcomeModal()" id="welcome-close-btn">
                    <i class="fas fa-check"></i> Start Browsing
                </button>
            </div>
        </div>
    </div>

    <!-- Check-in Modal -->
    <div id="checkin-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-calendar-check"></i> Daily Check-in</h3>
                <button class="modal-close" id="checkin-close-btn" onclick="closeCheckinModal()" disabled>
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
            <div class="modal-body">
                <p>Complete your daily check-in to earn points and maintain your streak!</p>
                
                <div class="modal-ad">
                    <h4>Complete Your Check-in</h4>
                    <p>Please view the ad below to complete your check-in</p>
                    <!-- Check-in Native Ad -->
                    <script async="async" data-cfasync="false" src="https://pl28624266.effectivegatecpm.com/6bc4ee56d47d8bd07693b3f7aff17fd1/invoke.js"></script> 
                    <div id="container-6bc4ee56d47d8bd07693b3f7aff17fd1"></div>
                </div>
                
                <div class="modal-progress" style="margin-top: 20px;">
                    <div class="modal-progress-bar">
                        <div id="checkin-progress-fill" class="modal-progress-fill"></div>
                    </div>
                    <div class="modal-progress-text">
                        <span>Check-in Progress:</span>
                        <span id="checkin-countdown">5</span> seconds
                    </div>
                </div>
                
                <div class="modal-buttons">
                    <button class="modal-btn modal-btn-primary" onclick="completeCheckin()" id="checkin-complete-btn" disabled>
                        <i class="fas fa-check-circle"></i> Complete Check-in
                    </button>
                    <button class="modal-btn modal-btn-secondary" onclick="closeCheckinModal()" id="checkin-cancel-btn">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reward Request Modal -->
    <div id="reward-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-gift"></i> Request Reward</h3>
                <button class="modal-close" onclick="closeRewardModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>Congratulations! You have completed 30 days. You can now request your reward.</p>
                
                <div class="form-group">
                    <label for="reward-upi">Enter UPI ID</label>
                    <input type="text" id="reward-upi" placeholder="Enter your UPI ID (e.g., name@upi)">
                    <small style="color: rgba(255, 255, 255, 0.6); display: block; margin-top: 5px;">
                        Reward will be sent to this UPI ID within 3 days
                    </small>
                </div>
                
                <div class="modal-ad">
                    <h4>ðŸŽ‰ Congratulations!</h4>
                    <p>You've successfully completed 30 daily check-ins!</p>
                </div>
                
                <div class="modal-buttons">
                    <button class="modal-btn modal-btn-primary" onclick="handleRewardRequest()" id="reward-submit-btn">
                        <i class="fas fa-paper-plane"></i> Submit Request
                    </button>
                    <button class="modal-btn modal-btn-secondary" onclick="closeRewardModal()">
                        Later
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCVRlmw3-PCtGd5s3R-a0fJQsBF1YjPRWI",
            authDomain: "uplodify-9eb07.firebaseapp.com",
            databaseURL: "https://uplodify-9eb07-default-rtdb.firebaseio.com",
            projectId: "uplodify-9eb07",
            storageBucket: "uplodify-9eb07.firebasestorage.app",
            messagingSenderId: "158848017856",
            appId: "1:158848017856:web:94aaaf14320490d52a5425",
            measurementId: "G-1PLGMECD19"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // Global Variables
        let currentUser = null;
        let userData = null;
        let timerInterval = null;
        let welcomeTimerInterval = null;
        let checkinTimerInterval = null;
        let timeLeft = 120; // 2 minutes
        let welcomeTimeLeft = 120;
        let checkinTimeLeft = 5;
        let activityDetected = false;
        let lastActivityTime = Date.now();
        let hasShownWelcomePopup = false;

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            checkAuthState();
            setupActivityDetection();
            setupEventListeners();
            createProgressDays();
        });

        // Setup Event Listeners
        function setupEventListeners() {
            // Enter key in login/register forms
            document.getElementById('login-email')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleLogin();
            });
            document.getElementById('login-password')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleLogin();
            });
            document.getElementById('register-email')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleRegister();
            });
            document.getElementById('register-password')?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleRegister();
            });
        }

        // Check Auth State
        function checkAuthState() {
            auth.onAuthStateChanged((user) => {
                if (user) {
                    currentUser = user;
                    loadUserData();
                } else {
                    showLoggedOutState();
                }
            });
        }

        // Load User Data
        async function loadUserData() {
            if (!currentUser) return;

            try {
                const snapshot = await database.ref(`users/${currentUser.uid}`).once('value');
                userData = snapshot.val();
                
                if (!userData) {
                    // Create new user data
                    const userReferralCode = generateReferralCode();
                    userData = {
                        email: currentUser.email,
                        points: 0,
                        activeDays: 0,
                        lastCheckIn: null,
                        rewardStatus: 'NOT_ELIGIBLE',
                        rewardRequestDate: null,
                        upi: null,
                        referralCode: userReferralCode,
                        referredBy: null,
                        referralRewarded: false,
                        joinDate: new Date().toISOString(),
                        referrals: 0,
                        referralPoints: 0,
                        streak: 0,
                        monthlyReferrals: 0,
                        lastReferralMonth: new Date().getMonth(),
                        totalEarnings: 0
                    };
                    
                    await database.ref(`users/${currentUser.uid}`).set(userData);
                }
                
                updateUI();
                showLoggedInState();
                
                // Show welcome popup if first visit today
                if (!userData.lastCheckIn || !isToday(new Date(userData.lastCheckIn))) {
                    setTimeout(() => {
                        openWelcomeModal();
                        startWelcomeTimer();
                    }, 1000);
                }
                
            } catch (error) {
                console.error('Error loading user data:', error);
                showToast('Error loading data');
            }
        }

        // Update UI
        function updateUI() {
            if (!userData) return;

            // Update header
            document.getElementById('header-username').textContent = userData.email.split('@')[0];
            document.getElementById('header-points').textContent = userData.points || 0;
            
            // Update stats
            const streak = calculateStreak();
            const activeDays = userData.activeDays || 0;
            const daysLeft = Math.max(0, 30 - activeDays);
            
            document.getElementById('current-streak').textContent = streak;
            document.getElementById('active-days').textContent = activeDays;
            document.getElementById('total-points').textContent = userData.points || 0;
            document.getElementById('days-remaining').textContent = daysLeft;
            
            // Update progress bar
            const progressPercent = Math.min(100, (activeDays / 30) * 100);
            document.getElementById('progress-percent').textContent = `${Math.round(progressPercent)}%`;
            document.getElementById('progress-fill').style.width = `${progressPercent}%`;
            
            // Update progress days
            updateProgressDays(activeDays);
            
            // Update check-in button
            if (userData.lastCheckIn && isToday(new Date(userData.lastCheckIn))) {
                document.getElementById('checkin-button').disabled = true;
                document.getElementById('checkin-text').textContent = 'Already Checked-in Today';
                document.getElementById('checkin-button').innerHTML = '<i class="fas fa-check-circle"></i> Already Checked-in Today';
            } else {
                document.getElementById('checkin-button').disabled = false;
                document.getElementById('checkin-text').textContent = 'Daily Check-in Available';
                document.getElementById('checkin-button').innerHTML = '<i class="fas fa-unlock"></i> Daily Check-in Available';
            }
            
            // Show/hide request status
            if (userData.rewardStatus === 'PENDING') {
                document.getElementById('request-status-section').style.display = 'block';
                document.getElementById('request-status-text').textContent = 'Your reward request is processing. It will be completed in 3 days.';
                if (userData.rewardRequestDate) {
                    const requestDate = new Date(userData.rewardRequestDate);
                    const deliveryDate = new Date(requestDate);
                    deliveryDate.setDate(deliveryDate.getDate() + 3);
                    document.getElementById('request-date').textContent = `Requested: ${requestDate.toLocaleDateString()} | Delivery: ${deliveryDate.toLocaleDateString()}`;
                }
            } else if (userData.rewardStatus === 'COMPLETED') {
                document.getElementById('request-status-section').style.display = 'block';
                document.getElementById('request-status-text').textContent = 'Your reward has been sent successfully!';
            } else {
                document.getElementById('request-status-section').style.display = 'none';
            }
            
            // Show reward modal if eligible
            if (activeDays >= 30 && userData.rewardStatus === 'NOT_ELIGIBLE') {
                setTimeout(() => {
                    openRewardModal();
                }, 2000);
            }
        }

        // Create Progress Days
        function createProgressDays() {
            const container = document.getElementById('progress-days');
            container.innerHTML = '';
            
            for (let i = 1; i <= 30; i++) {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'day-marker';
                dayDiv.textContent = i;
                dayDiv.id = `day-${i}`;
                container.appendChild(dayDiv);
            }
        }

        // Update Progress Days
        function updateProgressDays(activeDays) {
            for (let i = 1; i <= 30; i++) {
                const dayElement = document.getElementById(`day-${i}`);
                if (i <= activeDays) {
                    dayElement.classList.add('completed');
                } else {
                    dayElement.classList.remove('completed');
                }
                if (i === activeDays + 1) {
                    dayElement.classList.add('active');
                } else {
                    dayElement.classList.remove('active');
                }
            }
        }

        // Calculate Streak
        function calculateStreak() {
            if (!userData || !userData.lastCheckIn) return 0;
            
            const lastCheckIn = new Date(userData.lastCheckIn);
            const today = new Date();
            
            // Reset time for comparison
            lastCheckIn.setHours(0, 0, 0, 0);
            today.setHours(0, 0, 0, 0);
            
            if (lastCheckIn.getTime() === today.getTime()) {
                return userData.streak || 1;
            }
            
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            yesterday.setHours(0, 0, 0, 0);
            
            if (lastCheckIn.getTime() === yesterday.getTime()) {
                return (userData.streak || 1);
            }
            
            return 0;
        }

        // Check if date is today
        function isToday(date) {
            const today = new Date();
            return date.getDate() === today.getDate() &&
                   date.getMonth() === today.getMonth() &&
                   date.getFullYear() === today.getFullYear();
        }

        // Setup Activity Detection
        function setupActivityDetection() {
            const events = ['mousemove', 'touchstart', 'scroll', 'click', 'keydown'];
            
            events.forEach(event => {
                document.addEventListener(event, () => {
                    activityDetected = true;
                    lastActivityTime = Date.now();
                }, { passive: true });
            });
            
            // Check for inactivity
            setInterval(() => {
                const inactiveTime = Date.now() - lastActivityTime;
                if (inactiveTime > 10000) { // 10 seconds
                    activityDetected = false;
                }
            }, 5000);
        }

        // Show Logged In State
        function showLoggedInState() {
            document.getElementById('auth-buttons').style.display = 'none';
            document.getElementById('user-menu').style.display = 'flex';
            document.getElementById('main-content').style.display = 'block';
            
            // Close any open modals
            closeLoginModal();
            closeRegisterModal();
        }

        // Show Logged Out State
        function showLoggedOutState() {
            document.getElementById('auth-buttons').style.display = 'flex';
            document.getElementById('user-menu').style.display = 'none';
            document.getElementById('main-content').style.display = 'none';
        }

        // Open Modals
        function openLoginModal() {
            document.getElementById('login-modal').classList.add('active');
            document.getElementById('login-email').focus();
        }

        function openRegisterModal() {
            document.getElementById('register-modal').classList.add('active');
            document.getElementById('register-email').focus();
        }

        function openWelcomeModal() {
            if (!hasShownWelcomePopup) {
                document.getElementById('welcome-modal').classList.add('active');
                hasShownWelcomePopup = true;
            }
        }

        function openCheckinModal() {
            document.getElementById('checkin-modal').classList.add('active');
            startCheckinTimer();
        }

        function openRewardModal() {
            document.getElementById('reward-modal').classList.add('active');
        }

        // Close Modals
        function closeLoginModal() {
            document.getElementById('login-modal').classList.remove('active');
            document.getElementById('login-error').textContent = '';
            document.getElementById('login-email').value = '';
            document.getElementById('login-password').value = '';
        }

        function closeRegisterModal() {
            document.getElementById('register-modal').classList.remove('active');
            document.getElementById('register-error').textContent = '';
            document.getElementById('register-email').value = '';
            document.getElementById('register-password').value = '';
            document.getElementById('register-referral').value = '';
        }

        function closeWelcomeModal() {
            document.getElementById('welcome-modal').classList.remove('active');
            if (welcomeTimerInterval) {
                clearInterval(welcomeTimerInterval);
                welcomeTimerInterval = null;
            }
        }

        function closeCheckinModal() {
            document.getElementById('checkin-modal').classList.remove('active');
            if (checkinTimerInterval) {
                clearInterval(checkinTimerInterval);
                checkinTimerInterval = null;
            }
        }

        function closeRewardModal() {
            document.getElementById('reward-modal').classList.remove('active');
        }

        // Start Timers
        function startWelcomeTimer() {
            welcomeTimeLeft = 120;
            updateWelcomeTimer();
            
            welcomeTimerInterval = setInterval(() => {
                if (activityDetected) {
                    welcomeTimeLeft--;
                    updateWelcomeTimer();
                    
                    if (welcomeTimeLeft <= 0) {
                        clearInterval(welcomeTimerInterval);
                        document.getElementById('checkin-button').disabled = false;
                        document.getElementById('checkin-text').textContent = 'Daily Check-in Available';
                        document.getElementById('checkin-button').innerHTML = '<i class="fas fa-unlock"></i> Daily Check-in Available';
                        showToast('Daily check-in unlocked!');
                    }
                }
            }, 1000);
        }

        function startCheckinTimer() {
            checkinTimeLeft = 5;
            updateCheckinTimer();
            
            checkinTimerInterval = setInterval(() => {
                checkinTimeLeft--;
                updateCheckinTimer();
                
                if (checkinTimeLeft <= 0) {
                    clearInterval(checkinTimerInterval);
                    document.getElementById('checkin-complete-btn').disabled = false;
                    document.getElementById('checkin-close-btn').disabled = false;
                    document.getElementById('checkin-countdown').textContent = 'Ready!';
                }
            }, 1000);
        }

        // Update Timers
        function updateWelcomeTimer() {
            const minutes = Math.floor(welcomeTimeLeft / 60);
            const seconds = welcomeTimeLeft % 60;
            document.getElementById('welcome-timer').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            const progressPercent = ((120 - welcomeTimeLeft) / 120) * 100;
            document.getElementById('welcome-progress-fill').style.width = `${progressPercent}%`;
            document.getElementById('welcome-time-spent').textContent = `${Math.floor((120 - welcomeTimeLeft) / 60)}:${((120 - welcomeTimeLeft) % 60).toString().padStart(2, '0')}`;
        }

        function updateCheckinTimer() {
            document.getElementById('checkin-countdown').textContent = checkinTimeLeft;
            const progressPercent = ((5 - checkinTimeLeft) / 5) * 100;
            document.getElementById('checkin-progress-fill').style.width = `${progressPercent}%`;
        }

        // Handle Login
        async function handleLogin() {
            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value;
            const errorElement = document.getElementById('login-error');
            
            errorElement.textContent = '';
            
            if (!email || !password) {
                errorElement.textContent = 'Please enter both email and password';
                return;
            }
            
            if (!isValidEmail(email)) {
                errorElement.textContent = 'Please enter a valid email address';
                return;
            }
            
            try {
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                // Clear form
                document.getElementById('login-email').value = '';
                document.getElementById('login-password').value = '';
                
                // Show success
                showToast('Login successful!');
                closeLoginModal();
                
            } catch (error) {
                let errorMessage = 'Login failed. Please try again.';
                
                switch (error.code) {
                    case 'auth/user-not-found':
                        errorMessage = 'No account found with this email.';
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'Incorrect password.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Invalid email format.';
                        break;
                }
                
                errorElement.textContent = errorMessage;
            }
        }

        // Handle Register
        async function handleRegister() {
            const email = document.getElementById('register-email').value.trim();
            const password = document.getElementById('register-password').value;
            const referralCode = document.getElementById('register-referral').value.trim();
            const errorElement = document.getElementById('register-error');
            
            errorElement.textContent = '';
            
            if (!email || !password) {
                errorElement.textContent = 'Please enter both email and password';
                return;
            }
            
            if (!isValidEmail(email)) {
                errorElement.textContent = 'Please enter a valid email address';
                return;
            }
            
            if (password.length < 6) {
                errorElement.textContent = 'Password must be at least 6 characters';
                return;
            }
            
            try {
                // Check referral code if provided
                let referrerId = null;
                if (referralCode) {
                    referrerId = await validateReferralCode(referralCode);
                }
                
                // Create user
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                // Generate referral code
                const userReferralCode = generateReferralCode();
                
                // Create user data
                const userData = {
                    email: email,
                    points: referrerId ? 5 : 0, // Bonus for using referral
                    activeDays: 0,
                    lastCheckIn: null,
                    rewardStatus: 'NOT_ELIGIBLE',
                    rewardRequestDate: null,
                    upi: null,
                    referralCode: userReferralCode,
                    referredBy: referrerId ? referralCode : null,
                    referralRewarded: false,
                    joinDate: new Date().toISOString(),
                    referrals: 0,
                    referralPoints: 0,
                    streak: 0,
                    monthlyReferrals: 0,
                    lastReferralMonth: new Date().getMonth(),
                    totalEarnings: 0
                };
                
                // Save to database
                await database.ref(`users/${user.uid}`).set(userData);
                
                // Update referrer if needed
                if (referrerId) {
                    await updateReferrerData(referrerId, user.uid, email);
                }
                
                // Clear form
                document.getElementById('register-email').value = '';
                document.getElementById('register-password').value = '';
                document.getElementById('register-referral').value = '';
                
                // Show success
                showToast('Account created successfully!');
                closeRegisterModal();
                
            } catch (error) {
                let errorMessage = 'Registration failed. Please try again.';
                
                switch (error.code) {
                    case 'auth/email-already-in-use':
                        errorMessage = 'Email already registered. Please login instead.';
                        break;
                    case 'auth/weak-password':
                        errorMessage = 'Password is too weak.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Invalid email format.';
                        break;
                }
                
                errorElement.textContent = errorMessage;
            }
        }

        // Complete Check-in
        async function completeCheckin() {
            try {
                if (!currentUser || !userData) return;
                
                const today = new Date();
                const lastCheckIn = userData.lastCheckIn ? new Date(userData.lastCheckIn) : null;
                
                // Check if already checked in today
                if (lastCheckIn && isToday(lastCheckIn)) {
                    showToast('You have already checked in today!');
                    closeCheckinModal();
                    return;
                }
                
                // Calculate streak
                let streak = calculateStreak();
                if (lastCheckIn) {
                    const yesterday = new Date(today);
                    yesterday.setDate(yesterday.getDate() - 1);
                    
                    if (lastCheckIn.toDateString() === yesterday.toDateString()) {
                        streak += 1;
                    } else {
                        streak = 1;
                    }
                } else {
                    streak = 1;
                }
                
                // Calculate points
                const basePoints = 10;
                const streakBonus = streak >= 3 ? 5 : 0;
                const pointsEarned = basePoints + streakBonus;
                const newPoints = (userData.points || 0) + pointsEarned;
                const newActiveDays = (userData.activeDays || 0) + 1;
                
                // Update user data
                const updates = {
                    lastCheckIn: today.toISOString(),
                    activeDays: newActiveDays,
                    points: newPoints,
                    streak: streak
                };
                
                await database.ref(`users/${currentUser.uid}`).update(updates);
                
                // Update local data
                Object.assign(userData, updates);
                
                // Update UI
                updateUI();
                
                // Show success
                let message = `Check-in complete! +${basePoints} points earned.`;
                if (streakBonus > 0) {
                    message += ` +${streakBonus} streak bonus!`;
                }
                showToast(message);
                
                // Close modal
                closeCheckinModal();
                
                // Check for referral rewards
                if (userData.referredBy && !userData.rewardRewarded) {
                    await checkReferralRewards();
                }
                
                // Check if reached 30 days
                if (newActiveDays === 30) {
                    setTimeout(() => {
                        openRewardModal();
                    }, 1500);
                }
                
            } catch (error) {
                console.error('Error completing check-in:', error);
                showToast('Error completing check-in');
            }
        }

        // Handle Reward Request
        async function handleRewardRequest() {
            const upiId = document.getElementById('reward-upi').value.trim();
            
            if (!upiId) {
                showToast('Please enter your UPI ID');
                return;
            }
            
            if (!upiId.includes('@')) {
                showToast('Please enter a valid UPI ID (e.g., name@upi)');
                return;
            }
            
            try {
                const button = document.getElementById('reward-submit-btn');
                button.disabled = true;
                button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
                
                const rewardRequestDate = new Date().toISOString();
                
                // Update user data
                const updates = {
                    rewardStatus: 'PENDING',
                    rewardRequestDate: rewardRequestDate,
                    upi: upiId
                };
                
                await database.ref(`users/${currentUser.uid}`).update(updates);
                
                // Update local data
                Object.assign(userData, updates);
                
                // Update UI
                updateUI();
                
                // Show success
                showToast('Reward request submitted! Will be processed in 3 days.');
                closeRewardModal();
                
                // Simulate completion after 3 days
                setTimeout(async () => {
                    if (userData.rewardStatus === 'PENDING') {
                        await database.ref(`users/${currentUser.uid}/rewardStatus`).set('COMPLETED');
                        userData.rewardStatus = 'COMPLETED';
                        updateUI();
                        showToast('ðŸŽ‰ Your reward has been sent successfully!');
                    }
                }, 3 * 24 * 60 * 60 * 1000);
                
            } catch (error) {
                console.error('Error submitting reward request:', error);
                showToast('Error submitting request');
                document.getElementById('reward-submit-btn').disabled = false;
                document.getElementById('reward-submit-btn').innerHTML = '<i class="fas fa-paper-plane"></i> Submit Request';
            }
        }

        // Check Referral Rewards
        async function checkReferralRewards() {
            if (!userData || !userData.referredBy || userData.rewardRewarded) return;
            
            try {
                if ((userData.activeDays || 0) >= 3) {
                    // Find referrer
                    const usersSnapshot = await database.ref('users').once('value');
                    let referrerId = null;
                    
                    usersSnapshot.forEach((childSnapshot) => {
                        const user = childSnapshot.val();
                        if (user.referralCode === userData.referredBy) {
                            referrerId = childSnapshot.key;
                        }
                    });
                    
                    if (!referrerId) return;
                    
                    // Get referrer data
                    const referrerSnapshot = await database.ref(`users/${referrerId}`).once('value');
                    const referrerData = referrerSnapshot.val();
                    
                    if (!referrerData) return;
                    
                    // Check monthly limit
                    const currentMonth = new Date().getMonth();
                    const lastRewardMonth = referrerData.lastReferralMonth;
                    
                    if (lastRewardMonth === currentMonth && (referrerData.monthlyReferrals || 0) >= 5) {
                        return;
                    }
                    
                    // Award points
                    const referralPoints = 5;
                    const newReferrerPoints = (referrerData.points || 0) + referralPoints;
                    const newReferrals = (referrerData.referrals || 0) + 1;
                    const newMonthlyReferrals = ((referrerData.lastReferralMonth === currentMonth) ? 
                        (referrerData.monthlyReferrals || 0) : 0) + 1;
                    
                    // Update referrer
                    await database.ref(`users/${referrerId}`).update({
                        points: newReferrerPoints,
                        referrals: newReferrals,
                        monthlyReferrals: newMonthlyReferrals,
                        lastReferralMonth: currentMonth,
                        referralPoints: (referrerData.referralPoints || 0) + referralPoints
                    });
                    
                    // Update current user
                    await database.ref(`users/${currentUser.uid}`).update({
                        referralRewarded: true
                    });
                    
                    // If referrer is current user, update local data
                    if (referrerId === currentUser.uid) {
                        userData.points = newReferrerPoints;
                        userData.referrals = newReferrals;
                        updateUI();
                        showToast(`ðŸŽ‰ +${referralPoints} points from referral!`);
                    }
                }
            } catch (error) {
                console.error('Error checking referral rewards:', error);
            }
        }

        // Helper Functions
        function isValidEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        function generateReferralCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = 'CK30-';
            
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            return code;
        }

        async function validateReferralCode(code) {
            try {
                if (!code.startsWith('CK30-')) return null;
                
                const usersSnapshot = await database.ref('users').once('value');
                let referrerId = null;
                
                usersSnapshot.forEach((childSnapshot) => {
                    const user = childSnapshot.val();
                    if (user.referralCode === code) {
                        referrerId = childSnapshot.key;
                    }
                });
                
                return referrerId;
            } catch (error) {
                console.error('Error validating referral code:', error);
                return null;
            }
        }

        async function updateReferrerData(referrerId, newUserId, newUserEmail) {
            try {
                const referrerRef = database.ref(`users/${referrerId}`);
                const referrerSnapshot = await referrerRef.once('value');
                const referrerData = referrerSnapshot.val();
                
                if (!referrerData) return;
                
                // Add to referral list
                const referralKey = database.ref(`users/${referrerId}/referralList`).push().key;
                await database.ref(`users/${referrerId}/referralList/${referralKey}`).set({
                    userId: newUserId,
                    email: newUserEmail,
                    date: new Date().toISOString(),
                    status: 'PENDING'
                });
                
            } catch (error) {
                console.error('Error updating referrer data:', error);
            }
        }

        // Logout
        function logout() {
            auth.signOut();
            showToast('Logged out successfully');
        }

        // Show Toast
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('active');
            
            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }
    </script>
</body>
</html>
