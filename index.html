<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CheckIn30 - Daily Rewards Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Screen Management */
        .screen {
            display: none;
            min-height: 100vh;
        }

        .screen.active {
            display: block;
        }

        /* Loading Screen */
        #loading-screen {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.5s ease;
        }

        .loading-container {
            text-align: center;
        }

        .logo-animation {
            margin-bottom: 2rem;
            animation: pulse 2s infinite;
        }

        .logo-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: white;
        }

        .logo-text {
            font-family: 'Poppins', sans-serif;
            font-size: 3rem;
            font-weight: 700;
            color: white;
        }

        .loading-text {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 2rem;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 6px solid rgba(255, 255, 255, 0.3);
            border-top: 6px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        /* Auth Screen */
        #auth-screen {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            min-height: 100vh;
        }

        .auth-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 450px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.6s ease;
        }

        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .auth-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .auth-logo i {
            font-size: 2.5rem;
            color: #4cc9f0;
        }

        .auth-logo h2 {
            font-family: 'Poppins', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            color: white;
        }

        .auth-subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95rem;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .auth-tab {
            flex: 1;
            padding: 15px;
            background: transparent;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .auth-tab.active {
            color: #4cc9f0;
        }

        .auth-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #4cc9f0;
            border-radius: 2px;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .form-group input {
            width: 100%;
            padding: 14px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            font-size: 1rem;
            color: white;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #4cc9f0;
            box-shadow: 0 0 0 3px rgba(76, 201, 240, 0.1);
        }

        .form-group input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .optional {
            color: rgba(255, 255, 255, 0.6);
            font-weight: normal;
        }

        .error-message {
            color: #ff6b6b;
            font-size: 0.9rem;
            margin-top: 10px;
            text-align: center;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(76, 201, 240, 0.3);
        }

        .btn-secondary {
            background: #7209b7;
            color: white;
        }

        .btn-secondary:hover {
            background: #560bad;
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid #4cc9f0;
            color: #4cc9f0;
        }

        .btn-outline:hover {
            background: #4cc9f0;
            color: white;
        }

        .btn-large {
            padding: 16px 32px;
            font-size: 1.1rem;
        }

        .btn-full {
            width: 100%;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        /* Ad Banner on Auth */
        .auth-ad-banner {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px dashed rgba(255, 255, 255, 0.2);
        }

        .auth-ad-banner .ad-badge {
            background: #4361ee;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            display: inline-block;
            margin-bottom: 10px;
        }

        /* Main App */
        #app-container {
            display: none;
            min-height: 100vh;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
            padding: 10px 0;
            display: flex;
            justify-content: space-around;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 10px;
            min-width: 70px;
        }

        .nav-item.active {
            color: #4cc9f0;
            background: rgba(76, 201, 240, 0.1);
        }

        .nav-item i {
            font-size: 1.2rem;
        }

        .nav-item span {
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Main Content */
        .main-content {
            padding: 20px;
            padding-bottom: 80px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* Home Section */
        .welcome-card {
            background: linear-gradient(135deg, rgba(76, 201, 240, 0.1) 0%, rgba(67, 97, 238, 0.1) 100%);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(76, 201, 240, 0.2);
            animation: slideUp 0.6s ease;
        }

        .welcome-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .user-info h3 {
            font-size: 1.5rem;
            margin-bottom: 5px;
            color: #4cc9f0;
        }

        .user-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .points-badge {
            background: linear-gradient(135deg, #7209b7 0%, #3a0ca3 100%);
            padding: 10px 20px;
            border-radius: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card i {
            font-size: 2rem;
            color: #4cc9f0;
            margin-bottom: 10px;
        }

        .stat-card h3 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .stat-card p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        /* Timer Section */
        .timer-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .timer-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .timer-header i {
            font-size: 1.5rem;
            color: #4cc9f0;
        }

        .timer-progress {
            margin: 15px 0;
        }

        .timer-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .timer-fill {
            height: 100%;
            background: linear-gradient(90deg, #4cc9f0, #4361ee);
            border-radius: 4px;
            width: 0%;
            transition: width 1s linear;
        }

        .timer-text {
            display: flex;
            justify-content: space-between;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .checkin-btn {
            width: 100%;
            margin-top: 15px;
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
        }

        .feature-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
        }

        .feature-icon i {
            font-size: 1.5rem;
            color: white;
        }

        .feature-card h4 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: white;
        }

        .feature-card p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
            line-height: 1.4;
        }

        /* Ads Container */
        .ads-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .ads-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .ads-header h3 {
            font-size: 1.2rem;
            color: white;
        }

        .sponsored-badge {
            background: #4361ee;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .ads-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .ad-item {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px dashed rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .ad-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: #4cc9f0;
        }

        .ad-placeholder {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            margin-top: 15px;
            border: 2px dashed rgba(255, 255, 255, 0.2);
        }

        .ad-placeholder i {
            font-size: 2rem;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 10px;
        }

        /* Rewards Section */
        .reward-card {
            background: linear-gradient(135deg, rgba(114, 9, 183, 0.1) 0%, rgba(86, 11, 173, 0.1) 100%);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(114, 9, 183, 0.2);
        }

        .reward-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .reward-header i {
            font-size: 2rem;
            color: #7209b7;
        }

        .progress-container {
            margin: 25px 0;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.8);
        }

        .progress-bar {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #7209b7, #4361ee);
            border-radius: 5px;
            width: 0%;
            transition: width 1s ease;
        }

        .reward-status {
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }

        .status-not-eligible {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .status-eligible {
            background: rgba(76, 201, 240, 0.1);
            border: 1px solid rgba(76, 201, 240, 0.3);
        }

        .status-pending {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .status-completed {
            background: rgba(46, 204, 113, 0.1);
            border: 1px solid rgba(46, 204, 113, 0.3);
        }

        .reward-form {
            margin-top: 20px;
            display: none;
        }

        /* Referral Section */
        .referral-card {
            background: linear-gradient(135deg, rgba(67, 97, 238, 0.1) 0%, rgba(76, 201, 240, 0.1) 100%);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(67, 97, 238, 0.2);
        }

        .referral-code {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
            font-family: monospace;
            font-size: 1.5rem;
            letter-spacing: 2px;
            border: 2px dashed rgba(255, 255, 255, 0.3);
        }

        .referral-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .referral-stat {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
        }

        .referral-stat h4 {
            font-size: 1.5rem;
            margin-bottom: 5px;
            color: #4cc9f0;
        }

        .referral-rules {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .referral-rules ul {
            list-style: none;
            padding-left: 0;
        }

        .referral-rules li {
            padding: 8px 0;
            color: rgba(255, 255, 255, 0.8);
            position: relative;
            padding-left: 25px;
        }

        .referral-rules li:before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #4cc9f0;
            font-weight: bold;
        }

        /* Profile Section */
        .profile-card {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.1) 0%, rgba(255, 149, 0, 0.1) 100%);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 193, 7, 0.2);
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
        }

        .profile-avatar {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, #4cc9f0 0%, #4361ee 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-avatar i {
            font-size: 2.5rem;
            color: white;
        }

        .profile-info h3 {
            font-size: 1.5rem;
            margin-bottom: 5px;
            color: white;
        }

        .profile-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .profile-details {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        /* Popup Modals */
        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .popup-overlay.active {
            display: flex;
        }

        .popup-content {
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: popupSlideUp 0.4s ease;
        }

        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .popup-header h3 {
            font-size: 1.5rem;
            color: #4cc9f0;
        }

        .popup-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 1.2rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .popup-close:hover {
            color: #ff6b6b;
        }

        .popup-body {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
        }

        .popup-ad {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
            border: 1px dashed rgba(255, 255, 255, 0.2);
        }

        .popup-ad-badge {
            background: #4361ee;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            display: inline-block;
            margin-bottom: 15px;
        }

        .popup-timer {
            text-align: center;
            margin: 20px 0;
            font-size: 1.5rem;
            color: #4cc9f0;
            font-weight: bold;
        }

        .popup-action {
            width: 100%;
            margin-top: 20px;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 20px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .contact-btn {
            background: transparent;
            border: 2px solid #4cc9f0;
            color: #4cc9f0;
            padding: 10px 20px;
            border-radius: 10px;
            margin-top: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .contact-btn:hover {
            background: #4cc9f0;
            color: white;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes popupSlideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .stats-grid,
            .features-grid,
            .ads-grid,
            .referral-stats {
                grid-template-columns: 1fr;
            }

            .auth-container {
                padding: 25px;
                margin: 10px;
            }

            .main-content {
                padding: 15px;
                padding-bottom: 90px;
            }

            .popup-content {
                margin: 10px;
            }
        }

        @media (min-width: 768px) {
            .bottom-nav {
                max-width: 768px;
                left: 50%;
                transform: translateX(-50%);
                border-radius: 20px 20px 0 0;
                bottom: 20px;
            }
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(76, 201, 240, 0.9);
            color: white;
            padding: 12px 24px;
            border-radius: 10px;
            z-index: 3000;
            animation: slideUp 0.3s ease;
            display: none;
        }

        .toast.active {
            display: block;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(76, 201, 240, 0.5);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(76, 201, 240, 0.7);
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="screen active">
        <div class="loading-container">
            <div class="logo-animation">
                <i class="fas fa-calendar-check logo-icon"></i>
                <h1 class="logo-text">CheckIn30</h1>
            </div>
            <p class="loading-text">Loading application...</p>
            <div class="loading-spinner"></div>
        </div>
    </div>

    <!-- Auth Screen -->
    <div id="auth-screen" class="screen">
        <div class="auth-container">
            <div class="auth-header">
                <div class="auth-logo">
                    <i class="fas fa-calendar-check"></i>
                    <h2>CheckIn30</h2>
                </div>
                <p class="auth-subtitle">Sign in to start earning daily rewards</p>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">Login</button>
                <button class="auth-tab" data-tab="register">Register</button>
            </div>
            
            <div id="login-form" class="auth-form active">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" placeholder="Enter your password">
                </div>
                <button id="login-btn" class="btn btn-primary btn-full">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <p id="login-error" class="error-message"></p>
            </div>
            
            <div id="register-form" class="auth-form">
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="register-password">Password</label>
                    <input type="password" id="register-password" placeholder="Create password (min 6 chars)">
                </div>
                <div class="form-group">
                    <label for="referral-code-input">Referral Code <span class="optional">(Optional)</span></label>
                    <input type="text" id="referral-code-input" placeholder="Enter friend's referral code">
                </div>
                <button id="register-btn" class="btn btn-primary btn-full">
                    <i class="fas fa-user-plus"></i> Create Account
                </button>
                <p id="register-error" class="error-message"></p>
            </div>
            
            <!-- Single Banner Ad -->
            <div class="auth-ad-banner">
                <div class="ad-badge">Sponsored</div>
                <h4>Special Offer!</h4>
                <p>Complete 30 days and earn amazing rewards</p>
                <small>[Adstra Code Here - Banner 1]</small>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="app-container" class="screen">
        <!-- Main Content -->
        <main class="main-content">
            <!-- Home Section -->
            <section id="home-section" class="content-section active">
                <div class="welcome-card">
                    <div class="welcome-header">
                        <div class="user-info">
                            <h3 id="user-greeting">Welcome!</h3>
                            <p id="user-email">user@example.com</p>
                        </div>
                        <div class="points-badge">
                            <i class="fas fa-coins"></i>
                            <span id="user-points">0</span> Points
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <i class="fas fa-fire"></i>
                            <h3 id="streak-days">0</h3>
                            <p>Day Streak</p>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-calendar-check"></i>
                            <h3 id="active-days">0</h3>
                            <p>Active Days</p>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-clock"></i>
                            <h3 id="days-left">30</h3>
                            <p>Days Left</p>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-trophy"></i>
                            <h3 id="reward-status-icon">‚ùå</h3>
                            <p>Reward Status</p>
                        </div>
                    </div>
                </div>

                <!-- Timer Section -->
                <div class="timer-section">
                    <div class="timer-header">
                        <i class="fas fa-hourglass-half"></i>
                        <div>
                            <h4>Daily Check-in Timer</h4>
                            <p id="timer-message">‚è≥ Explore website for 2 minutes to unlock check-in</p>
                        </div>
                    </div>
                    
                    <div class="timer-progress">
                        <div class="timer-bar">
                            <div id="timer-fill" class="timer-fill"></div>
                        </div>
                        <div class="timer-text">
                            <span>Time Spent:</span>
                            <span id="timer-display">0:00 / 2:00</span>
                        </div>
                    </div>
                    
                    <button id="checkin-btn" class="btn btn-primary btn-full checkin-btn" disabled>
                        <i class="fas fa-lock"></i>
                        <span id="checkin-text">Unlock Daily Check-in</span>
                    </button>
                </div>

                <!-- Features -->
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-gift"></i>
                        </div>
                        <h4>Daily Rewards</h4>
                        <p>Earn points every day with simple check-ins</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h4>Trusted System</h4>
                        <p>Secure platform with verified payouts</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <h4>Fast Processing</h4>
                        <p>Rewards delivered within 3 days</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <h4>Refer Friends</h4>
                        <p>Earn bonus points for referrals</p>
                    </div>
                </div>

                <!-- Ads Section -->
                <div class="ads-container">
                    <div class="ads-header">
                        <h3>Sponsored Content</h3>
                        <span class="sponsored-badge">Ads</span>
                    </div>
                    
                    <div class="ads-grid">
                        <div class="ad-item">[Adstra Code Here - Ad 2]</div>
                        <div class="ad-item">[Adstra Code Here - Ad 3]</div>
                        <div class="ad-item">[Adstra Code Here - Ad 4]</div>
                        <div class="ad-item">[Adstra Code Here - Ad 5]</div>
                        <div class="ad-item">[Adstra Code Here - Ad 6]</div>
                        <div class="ad-item">[Adstra Code Here - Ad 7]</div>
                    </div>
                    
                    <div class="ad-placeholder">
                        <i class="fas fa-ad"></i>
                        <p>Advertisement Space</p>
                        <small>[Adstra Code Here - Ad 8]</small>
                    </div>
                </div>
            </section>

            <!-- Rewards Section -->
            <section id="rewards-section" class="content-section">
                <div class="reward-card">
                    <div class="reward-header">
                        <i class="fas fa-award"></i>
                        <div>
                            <h3>30-Day Reward Program</h3>
                            <p>Complete 30 days to unlock your reward</p>
                        </div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-info">
                            <span>Progress: <strong id="progress-days">0</strong>/30 days</span>
                            <span id="progress-percent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div id="progress-fill" class="progress-fill"></div>
                        </div>
                    </div>
                    
                    <div id="reward-status" class="reward-status status-not-eligible">
                        <i class="fas fa-info-circle"></i>
                        <p id="reward-message">Complete 30 days to become eligible</p>
                    </div>
                    
                    <div id="reward-form" class="reward-form">
                        <div class="form-group">
                            <label for="upi-id">Enter UPI ID for Reward</label>
                            <input type="text" id="upi-id" placeholder="e.g., name@upi">
                            <small style="color: rgba(255, 255, 255, 0.6); display: block; margin-top: 5px;">
                                Reward will be sent within 3 days after request
                            </small>
                        </div>
                        <button id="request-reward-btn" class="btn btn-primary btn-full">
                            <i class="fas fa-paper-plane"></i> Submit Reward Request
                        </button>
                    </div>
                </div>
                
                <!-- More Ads -->
                <div class="ads-container">
                    <div class="ads-header">
                        <h3>More Offers</h3>
                        <span class="sponsored-badge">Sponsored</span>
                    </div>
                    <div class="ads-grid">
                        <div class="ad-item">[Adstra Code Here - Ad 9]</div>
                        <div class="ad-item">[Adstra Code Here - Ad 10]</div>
                    </div>
                </div>
            </section>

            <!-- Referral Section -->
            <section id="referral-section" class="content-section">
                <div class="referral-card">
                    <div class="reward-header">
                        <i class="fas fa-user-plus"></i>
                        <div>
                            <h3>Refer & Earn</h3>
                            <p>Invite friends and earn bonus points</p>
                        </div>
                    </div>
                    
                    <div class="referral-code" id="referral-code">
                        Loading...
                    </div>
                    
                    <button id="copy-referral-btn" class="btn btn-secondary btn-full" style="margin-bottom: 20px;">
                        <i class="fas fa-copy"></i> Copy Referral Code
                    </button>
                    
                    <div class="referral-stats">
                        <div class="referral-stat">
                            <h4 id="total-referrals">0</h4>
                            <p>Total Referrals</p>
                        </div>
                        <div class="referral-stat">
                            <h4 id="referral-earnings">0</h4>
                            <p>Points Earned</p>
                        </div>
                        <div class="referral-stat">
                            <h4 id="monthly-limit">5</h4>
                            <p>Monthly Limit</p>
                        </div>
                        <div class="referral-stat">
                            <h4 id="referrals-left">5</h4>
                            <p>Left This Month</p>
                        </div>
                    </div>
                    
                    <div class="referral-rules">
                        <h4>Referral Rules:</h4>
                        <ul>
                            <li>Each user gets unique referral code</li>
                            <li>Earn +5 points per successful referral</li>
                            <li>Referred user must complete 3 check-ins</li>
                            <li>Max 5 referrals rewarded per month</li>
                            <li>System is safe and fraud-protected</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Referral Ads -->
                <div class="ads-container">
                    <div class="ads-header">
                        <h3>Special Offers</h3>
                        <span class="sponsored-badge">Sponsored</span>
                    </div>
                    <div class="ad-placeholder">
                        <i class="fas fa-bullhorn"></i>
                        <p>Advertisement Space</p>
                        <small>[Adstra Code Here - Ad 11]</small>
                    </div>
                </div>
            </section>

            <!-- Profile Section -->
            <section id="profile-section" class="content-section">
                <div class="profile-card">
                    <div class="profile-header">
                        <div class="profile-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="profile-info">
                            <h3 id="profile-email">user@example.com</h3>
                            <p>Member since <span id="join-date">Loading...</span></p>
                        </div>
                    </div>
                    
                    <div class="profile-details">
                        <div class="detail-item">
                            <span>Total Points:</span>
                            <strong id="profile-points">0</strong>
                        </div>
                        <div class="detail-item">
                            <span>Active Days:</span>
                            <strong id="profile-active-days">0</strong>
                        </div>
                        <div class="detail-item">
                            <span>Current Streak:</span>
                            <strong id="profile-streak">0 days</strong>
                        </div>
                        <div class="detail-item">
                            <span>Last Check-in:</span>
                            <strong id="last-checkin">Never</strong>
                        </div>
                        <div class="detail-item">
                            <span>Reward Status:</span>
                            <strong id="profile-reward-status">Not Eligible</strong>
                        </div>
                    </div>
                    
                    <button id="reset-timer-btn" class="btn btn-outline btn-full" style="margin-top: 20px;">
                        <i class="fas fa-redo"></i> Reset Daily Timer
                    </button>
                </div>
                
                <!-- Contact Section -->
                <div class="ads-container" style="text-align: center;">
                    <h3>Need Help?</h3>
                    <p style="margin: 15px 0; color: rgba(255, 255, 255, 0.8);">
                        Contact us for any queries or support
                    </p>
                    <button id="contact-btn" class="contact-btn">
                        <i class="fas fa-envelope"></i> Connect With Support
                    </button>
                </div>
                
                <!-- More Ads -->
                <div class="ads-container">
                    <div class="ads-header">
                        <h3>Sponsored</h3>
                        <span class="sponsored-badge">Ads</span>
                    </div>
                    <div class="ad-placeholder">
                        <i class="fas fa-ad"></i>
                        <p>Advertisement Space</p>
                        <small>[Adstra Code Here - Ad 12]</small>
                    </div>
                    <div style="margin-top: 15px; text-align: center;">
                        <div class="ad-item">[Adstra Code Here - Ad 13]</div>
                        <div class="ad-item">[Adstra Code Here - Ad 14]</div>
                        <div class="ad-item">[Adstra Code Here - Ad 15]</div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" data-section="home">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </button>
            <button class="nav-item" data-section="rewards">
                <i class="fas fa-gift"></i>
                <span>Rewards</span>
            </button>
            <button class="nav-item" data-section="referral">
                <i class="fas fa-users"></i>
                <span>Referral</span>
            </button>
            <button class="nav-item" data-section="profile">
                <i class="fas fa-user"></i>
                <span>Profile</span>
            </button>
        </nav>

        <!-- Footer -->
        <footer class="footer">
            <p>¬© 2024 CheckIn30. All rights reserved.</p>
            <p style="font-size: 0.8rem; margin-top: 5px; opacity: 0.5;">
                Daily check-ins for consistent rewards
            </p>
        </footer>
    </div>

    <!-- Popup Modals -->
    
    <!-- Welcome Popup (Shows on first visit) -->
    <div id="welcome-popup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-header">
                <h3>üéâ Welcome to CheckIn30!</h3>
                <button class="popup-close" onclick="closePopup('welcome-popup')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="popup-body">
                <p>To unlock daily check-in, please explore the website for <strong>2 minutes</strong>.</p>
                <div class="popup-ad">
                    <div class="popup-ad-badge">Sponsored</div>
                    <h4>Start Earning Today!</h4>
                    <p>Complete your first check-in and earn points</p>
                    <small>[Adstra Code Here - Welcome Ad]</small>
                </div>
                <p>Timer will start automatically. Move your mouse, scroll, or click anywhere on the website.</p>
                <div class="popup-timer" id="welcome-timer">2:00</div>
                <button class="btn btn-primary btn-full popup-action" onclick="closePopup('welcome-popup')">
                    <i class="fas fa-check"></i> Got it, let's explore!
                </button>
            </div>
        </div>
    </div>

    <!-- Daily Visit Popup (Shows every visit) -->
    <div id="visit-popup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-header">
                <h3>‚è∞ Daily Visit Required</h3>
                <button class="popup-close" onclick="closePopup('visit-popup')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="popup-body">
                <p>Visit required to maintain your streak! Explore the website to unlock check-in.</p>
                <div class="popup-ad">
                    <div class="popup-ad-badge">Sponsored</div>
                    <h4>Special Offer Inside!</h4>
                    <p>Check our offers section for amazing deals</p>
                    <small>[Adstra Code Here - Visit Ad]</small>
                </div>
                <p>Already visited today? You can still browse but streak won't increase.</p>
                <button class="btn btn-secondary btn-full popup-action" onclick="closePopup('visit-popup')">
                    <i class="fas fa-eye"></i> Browse Website
                </button>
            </div>
        </div>
    </div>

    <!-- Check-in Popup (Shows when unlocking check-in) -->
    <div id="checkin-popup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-header">
                <h3>‚úÖ Daily Check-in</h3>
                <button class="popup-close" id="checkin-close-btn" disabled>
                    <i class="fas fa-times"></i> Close (5s)
                </button>
            </div>
            <div class="popup-body">
                <p>Complete your daily check-in to earn points and maintain streak!</p>
                
                <div class="popup-ad">
                    <div class="popup-ad-badge">Sponsored</div>
                    <h4>Exclusive Offer!</h4>
                    <p>Limited time deal for active users</p>
                    <small>[Adstra Code Here - Check-in Ad]</small>
                </div>
                
                <div style="text-align: center; margin: 20px 0;">
                    <i class="fas fa-gift fa-3x" style="color: #4cc9f0;"></i>
                    <h4 style="margin-top: 10px;">+10 Points Reward</h4>
                </div>
                
                <div id="checkin-countdown" class="popup-timer">5</div>
                <p style="text-align: center; font-size: 0.9rem; color: rgba(255, 255, 255, 0.7);">
                    Close button will be enabled in <span id="countdown-text">5</span> seconds
                </p>
            </div>
        </div>
    </div>

    <!-- Contact Popup -->
    <div id="contact-popup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-header">
                <h3>üìß Contact Support</h3>
                <button class="popup-close" onclick="closePopup('contact-popup')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="popup-body">
                <p>For any queries or support, please email us:</p>
                <div style="text-align: center; margin: 25px 0;">
                    <i class="fas fa-envelope fa-3x" style="color: #4cc9f0;"></i>
                    <h3 style="margin-top: 15px;">
                        <a href="mailto:gotmprajapat00@gmail.com" style="color: #4cc9f0; text-decoration: none;">
                            gotmprajapat00@gmail.com
                        </a>
                    </h3>
                </div>
                <p>We'll respond to your query within 24 hours.</p>
                <button class="btn btn-primary btn-full popup-action" onclick="window.location.href='mailto:gotmprajapat00@gmail.com'">
                    <i class="fas fa-paper-plane"></i> Send Email Now
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCVRlmw3-PCtGd5s3R-a0fJQsBF1YjPRWI",
            authDomain: "uplodify-9eb07.firebaseapp.com",
            databaseURL: "https://uplodify-9eb07-default-rtdb.firebaseio.com",
            projectId: "uplodify-9eb07",
            storageBucket: "uplodify-9eb07.firebasestorage.app",
            messagingSenderId: "158848017856",
            appId: "1:158848017856:web:94aaaf14320490d52a5425",
            measurementId: "G-1PLGMECD19"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // Global Variables
        let currentUser = null;
        let userData = null;
        let timerInterval = null;
        let visitTimer = null;
        let timeLeft = 120; // 2 minutes in seconds
        let timerActive = false;
        let activityDetected = false;
        let lastActivityTime = Date.now();
        let hasShownWelcomePopup = false;
        let hasShownVisitPopup = false;

        // DOM Elements
        const screens = {
            loading: document.getElementById('loading-screen'),
            auth: document.getElementById('auth-screen'),
            app: document.getElementById('app-container')
        };

        const popups = {
            welcome: document.getElementById('welcome-popup'),
            visit: document.getElementById('visit-popup'),
            checkin: document.getElementById('checkin-popup'),
            contact: document.getElementById('contact-popup')
        };

        // Initialize Application
        document.addEventListener('DOMContentLoaded', () => {
            initializeEventListeners();
            checkAuthState();
            setupActivityDetection();
        });

        // Event Listeners
        function initializeEventListeners() {
            // Auth Tabs
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.dataset.tab;
                    switchAuthTab(tabName);
                });
            });

            // Auth Buttons
            document.getElementById('login-btn').addEventListener('click', handleLogin);
            document.getElementById('register-btn').addEventListener('click', handleRegister);

            // Navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    switchSection(item.dataset.section);
                });
            });

            // Check-in Button
            document.getElementById('checkin-btn').addEventListener('click', openCheckinPopup);

            // Copy Referral Code
            document.getElementById('copy-referral-btn').addEventListener('click', copyReferralCode);

            // Request Reward
            document.getElementById('request-reward-btn')?.addEventListener('click', handleRewardRequest);

            // Reset Timer
            document.getElementById('reset-timer-btn')?.addEventListener('click', resetDailyTimer);

            // Contact Button
            document.getElementById('contact-btn').addEventListener('click', () => {
                openPopup('contact-popup');
            });

            // Check-in Close Button
            document.getElementById('checkin-close-btn').addEventListener('click', completeCheckin);
        }

        // Check Auth State
        function checkAuthState() {
            auth.onAuthStateChanged((user) => {
                if (user) {
                    currentUser = user;
                    loadUserData();
                } else {
                    showScreen('auth');
                }
            });
        }

        // Switch Auth Tab
        function switchAuthTab(tabName) {
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.tab === tabName);
            });
            
            document.querySelectorAll('.auth-form').forEach(form => {
                form.classList.toggle('active', form.id === `${tabName}-form`);
            });
        }

        // Handle Login
        async function handleLogin() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const errorElement = document.getElementById('login-error');
            const button = document.getElementById('login-btn');

            if (!email || !password) {
                errorElement.textContent = 'Please enter both email and password';
                return;
            }

            try {
                button.disabled = true;
                button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Logging in...';
                
                await auth.signInWithEmailAndPassword(email, password);
                errorElement.textContent = '';
            } catch (error) {
                errorElement.textContent = getErrorMessage(error);
                button.disabled = false;
                button.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
            }
        }

        // Handle Register
        async function handleRegister() {
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const referralCode = document.getElementById('referral-code-input').value;
            const errorElement = document.getElementById('register-error');
            const button = document.getElementById('register-btn');

            if (!email || !password) {
                errorElement.textContent = 'Please enter both email and password';
                return;
            }

            if (password.length < 6) {
                errorElement.textContent = 'Password must be at least 6 characters';
                return;
            }

            try {
                button.disabled = true;
                button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating account...';
                
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                // Generate referral code
                const userReferralCode = 'CK30-' + generateRandomCode(6);
                
                // Prepare user data
                const userData = {
                    email: email,
                    points: 0,
                    activeDays: 0,
                    lastCheckIn: null,
                    rewardStatus: 'NOT_ELIGIBLE',
                    rewardRequestDate: null,
                    upi: null,
                    referralCode: userReferralCode,
                    referredBy: referralCode || null,
                    referralRewarded: false,
                    joinDate: new Date().toISOString(),
                    referrals: 0,
                    referralPoints: 0,
                    streak: 0,
                    monthlyReferrals: 0,
                    lastReferralMonth: new Date().getMonth()
                };

                // Save user data to database
                await database.ref(`users/${user.uid}`).set(userData);
                
                // If referral code was used, update referrer's data
                if (referralCode) {
                    await handleReferralSignup(referralCode, user.uid);
                }
                
                errorElement.textContent = '';
            } catch (error) {
                errorElement.textContent = getErrorMessage(error);
                button.disabled = false;
                button.innerHTML = '<i class="fas fa-user-plus"></i> Create Account';
            }
        }

        // Load User Data
        async function loadUserData() {
            if (!currentUser) return;

            try {
                const snapshot = await database.ref(`users/${currentUser.uid}`).once('value');
                userData = snapshot.val();
                
                if (!userData) {
                    // Create user data if it doesn't exist
                    const userReferralCode = 'CK30-' + generateRandomCode(6);
                    userData = {
                        email: currentUser.email,
                        points: 0,
                        activeDays: 0,
                        lastCheckIn: null,
                        rewardStatus: 'NOT_ELIGIBLE',
                        rewardRequestDate: null,
                        upi: null,
                        referralCode: userReferralCode,
                        referredBy: null,
                        referralRewarded: false,
                        joinDate: new Date().toISOString(),
                        referrals: 0,
                        referralPoints: 0,
                        streak: 0,
                        monthlyReferrals: 0,
                        lastReferralMonth: new Date().getMonth()
                    };
                    
                    await database.ref(`users/${currentUser.uid}`).set(userData);
                }
                
                updateUI();
                showScreen('app');
                
                // Show popups based on user status
                showWelcomePopup();
                showVisitPopup();
                
                // Check if user can check in today
                checkDailyCheckin();
                
                // Start timer if needed
                startVisitTimer();
                
            } catch (error) {
                console.error('Error loading user data:', error);
            }
        }

        // Update UI with User Data
        function updateUI() {
            if (!userData) return;

            // Update user info
            document.getElementById('user-greeting').textContent = `Welcome, ${userData.email.split('@')[0]}!`;
            document.getElementById('user-email').textContent = userData.email;
            document.getElementById('user-points').textContent = userData.points || 0;
            
            // Update stats
            const streak = calculateStreak();
            document.getElementById('streak-days').textContent = streak;
            document.getElementById('active-days').textContent = userData.activeDays || 0;
            document.getElementById('days-left').textContent = Math.max(0, 30 - (userData.activeDays || 0));
            
            // Update reward status icon
            const rewardIcon = document.getElementById('reward-status-icon');
            if (userData.rewardStatus === 'COMPLETED') {
                rewardIcon.textContent = '‚úÖ';
                rewardIcon.style.color = '#2ecc71';
            } else if (userData.rewardStatus === 'PENDING') {
                rewardIcon.textContent = '‚è≥';
                rewardIcon.style.color = '#f39c12';
            } else if ((userData.activeDays || 0) >= 30) {
                rewardIcon.textContent = 'üéÅ';
                rewardIcon.style.color = '#9b59b6';
            } else {
                rewardIcon.textContent = '‚ùå';
                rewardIcon.style.color = '#e74c3c';
            }
            
            // Update profile section
            document.getElementById('profile-email').textContent = userData.email;
            document.getElementById('profile-points').textContent = userData.points || 0;
            document.getElementById('profile-active-days').textContent = userData.activeDays || 0;
            document.getElementById('profile-streak').textContent = streak + ' days';
            document.getElementById('profile-reward-status').textContent = getRewardStatusText(userData.rewardStatus);
            
            if (userData.lastCheckIn) {
                const lastCheckin = new Date(userData.lastCheckIn);
                document.getElementById('last-checkin').textContent = lastCheckin.toLocaleDateString();
            }
            
            if (userData.joinDate) {
                const joinDate = new Date(userData.joinDate);
                document.getElementById('join-date').textContent = joinDate.toLocaleDateString();
            }
            
            // Update referral section
            document.getElementById('referral-code').textContent = userData.referralCode || 'Loading...';
            document.getElementById('total-referrals').textContent = userData.referrals || 0;
            document.getElementById('referral-earnings').textContent = userData.referralPoints || 0;
            
            const currentMonth = new Date().getMonth();
            const monthlyReferrals = (userData.lastReferralMonth === currentMonth) ? (userData.monthlyReferrals || 0) : 0;
            document.getElementById('referrals-left').textContent = Math.max(0, 5 - monthlyReferrals);
            
            // Update rewards section
            updateRewardsSection();
        }

        // Calculate Streak
        function calculateStreak() {
            if (!userData || !userData.lastCheckIn) return 0;
            
            const lastCheckIn = new Date(userData.lastCheckIn);
            const today = new Date();
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            // Check if last check-in was today
            if (lastCheckIn.toDateString() === today.toDateString()) {
                return userData.streak || 1;
            }
            // Check if last check-in was yesterday
            else if (lastCheckIn.toDateString() === yesterday.toDateString()) {
                return (userData.streak || 1);
            }
            // Streak broken
            else {
                return 0;
            }
        }

        // Show Welcome Popup (First visit only)
        function showWelcomePopup() {
            if (!hasShownWelcomePopup) {
                setTimeout(() => {
                    openPopup('welcome-popup');
                    hasShownWelcomePopup = true;
                }, 1000);
            }
        }

        // Show Visit Popup (Every visit)
        function showVisitPopup() {
            if (!hasShownVisitPopup) {
                setTimeout(() => {
                    openPopup('visit-popup');
                    hasShownVisitPopup = true;
                }, 1500);
            }
        }

        // Open Popup
        function openPopup(popupId) {
            const popup = document.getElementById(popupId);
            if (popup) {
                popup.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        // Close Popup
        function closePopup(popupId) {
            const popup = document.getElementById(popupId);
            if (popup) {
                popup.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }

        // Start Visit Timer
        function startVisitTimer() {
            // Check if already checked in today
            if (userData && userData.lastCheckIn) {
                const lastCheckIn = new Date(userData.lastCheckIn);
                const today = new Date();
                
                if (lastCheckIn.toDateString() === today.toDateString()) {
                    // Already checked in today
                    updateCheckinButton(true);
                    return;
                }
            }
            
            // Start timer
            timerActive = true;
            timeLeft = 120;
            updateTimerDisplay();
            
            timerInterval = setInterval(() => {
                if (activityDetected) {
                    timeLeft--;
                    
                    if (timeLeft <= 0) {
                        stopTimer();
                        unlockCheckinButton();
                    } else {
                        updateTimerDisplay();
                    }
                }
            }, 1000);
        }

        // Stop Timer
        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            timerActive = false;
        }

        // Update Timer Display
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            
            document.getElementById('timer-display').textContent = 
                `${minutes}:${seconds.toString().padStart(2, '0')} / 2:00`;
            
            // Update progress bar
            const progress = ((120 - timeLeft) / 120) * 100;
            document.getElementById('timer-fill').style.width = `${progress}%`;
            
            // Update message
            if (timeLeft > 0) {
                document.getElementById('timer-message').textContent = 
                    `‚è≥ Explore website to unlock check-in (${minutes}:${seconds.toString().padStart(2, '0')} left)`;
            }
        }

        // Setup Activity Detection
        function setupActivityDetection() {
            // Mouse movement
            document.addEventListener('mousemove', () => {
                activityDetected = true;
                updateActivityTime();
            });
            
            // Touch events
            document.addEventListener('touchstart', () => {
                activityDetected = true;
                updateActivityTime();
            });
            
            // Scroll events
            document.addEventListener('scroll', () => {
                activityDetected = true;
                updateActivityTime();
            });
            
            // Click events
            document.addEventListener('click', () => {
                activityDetected = true;
                updateActivityTime();
            });
            
            // Keyboard events
            document.addEventListener('keydown', () => {
                activityDetected = true;
                updateActivityTime();
            });
        }

        // Update Activity Time
        function updateActivityTime() {
            lastActivityTime = Date.now();
            
            // Check for inactivity every 5 seconds
            if (!activityDetected) {
                activityDetected = true;
            }
            
            setInterval(() => {
                const inactiveTime = Date.now() - lastActivityTime;
                if (inactiveTime > 10000) { // 10 seconds of inactivity
                    activityDetected = false;
                    if (timerActive) {
                        document.getElementById('timer-message').textContent = 
                            '‚è≥ Timer paused - interact with website to continue';
                    }
                }
            }, 5000);
        }

        // Unlock Check-in Button
        function unlockCheckinButton() {
            document.getElementById('checkin-btn').disabled = false;
            document.getElementById('checkin-btn').innerHTML = 
                '<i class="fas fa-unlock"></i> Daily Check-in Available';
            document.getElementById('timer-message').textContent = '‚úÖ Daily Check-in Available!';
            document.getElementById('timer-message').style.color = '#2ecc71';
            
            showToast('üéâ Daily check-in unlocked! Click to claim your reward.');
        }

        // Update Check-in Button
        function updateCheckinButton(completed) {
            const button = document.getElementById('checkin-btn');
            if (completed) {
                button.disabled = true;
                button.innerHTML = '<i class="fas fa-check-circle"></i> Already Checked-in Today';
                document.getElementById('timer-message').textContent = '‚úÖ Daily check-in completed';
                document.getElementById('timer-message').style.color = '#2ecc71';
            }
        }

        // Open Check-in Popup
        function openCheckinPopup() {
            openPopup('checkin-popup');
            
            // Start countdown for close button
            let countdown = 5;
            const countdownElement = document.getElementById('countdown-text');
            const closeButton = document.getElementById('checkin-close-btn');
            const countdownDisplay = document.getElementById('checkin-countdown');
            
            const countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                countdownDisplay.textContent = countdown;
                closeButton.innerHTML = `<i class="fas fa-times"></i> Close (${countdown}s)`;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    closeButton.disabled = false;
                    closeButton.innerHTML = '<i class="fas fa-times"></i> Close & Complete';
                    closeButton.style.background = '#4cc9f0';
                    closeButton.style.color = 'white';
                }
            }, 1000);
        }

        // Complete Check-in
        async function completeCheckin() {
            try {
                if (!currentUser || !userData) return;
                
                const today = new Date();
                const lastCheckIn = userData.lastCheckIn ? new Date(userData.lastCheckIn) : null;
                
                // Check if already checked in today
                if (lastCheckIn && lastCheckIn.toDateString() === today.toDateString()) {
                    showToast('You have already checked in today!');
                    closePopup('checkin-popup');
                    return;
                }
                
                // Calculate streak
                let streak = calculateStreak();
                if (lastCheckIn) {
                    const yesterday = new Date(today);
                    yesterday.setDate(yesterday.getDate() - 1);
                    
                    if (lastCheckIn.toDateString() === yesterday.toDateString()) {
                        streak += 1;
                    } else {
                        streak = 1;
                    }
                } else {
                    streak = 1;
                }
                
                // Calculate points (10 points per check-in + 5 for streak bonus)
                const basePoints = 10;
                const streakBonus = streak >= 3 ? 5 : 0;
                const pointsEarned = basePoints + streakBonus;
                const newPoints = (userData.points || 0) + pointsEarned;
                
                // Update user data
                const updates = {
                    lastCheckIn: today.toISOString(),
                    activeDays: (userData.activeDays || 0) + 1,
                    points: newPoints,
                    streak: streak
                };
                
                await database.ref(`users/${currentUser.uid}`).update(updates);
                
                // Update local userData
                Object.assign(userData, updates);
                
                // Update UI
                updateUI();
                
                // Show success message
                let message = `‚úÖ Daily check-in completed! +${basePoints} points earned.`;
                if (streakBonus > 0) {
                    message += ` +${streakBonus} streak bonus!`;
                }
                showToast(message);
                
                // Close popup
                closePopup('checkin-popup');
                
                // Update check-in button
                updateCheckinButton(true);
                
                // Reset timer for next day
                stopTimer();
                
                // Check for referral rewards
                await checkReferralRewards();
                
            } catch (error) {
                console.error('Error completing check-in:', error);
                showToast('Error completing check-in. Please try again.');
            }
        }

        // Check Referral Rewards
        async function checkReferralRewards() {
            if (!currentUser || !userData || !userData.referredBy) return;
            
            try {
                // Find referrer by referral code
                const usersSnapshot = await database.ref('users').once('value');
                let referrerId = null;
                
                usersSnapshot.forEach((childSnapshot) => {
                    const user = childSnapshot.val();
                    if (user.referralCode === userData.referredBy) {
                        referrerId = childSnapshot.key;
                    }
                });
                
                if (!referrerId) return;
                
                // Get referrer's data
                const referrerSnapshot = await database.ref(`users/${referrerId}`).once('value');
                const referrerData = referrerSnapshot.val();
                
                if (!referrerData) return;
                
                // Check if referral already rewarded
                if (userData.referralRewarded) return;
                
                // Check if user has completed 3 check-ins
                if ((userData.activeDays || 0) >= 3) {
                    // Check monthly limit
                    const currentMonth = new Date().getMonth();
                    const lastRewardMonth = referrerData.lastReferralMonth;
                    
                    if (lastRewardMonth === currentMonth && (referrerData.monthlyReferrals || 0) >= 5) {
                        return; // Monthly limit reached
                    }
                    
                    // Award referral points
                    const referralPoints = 5;
                    const newReferrerPoints = (referrerData.points || 0) + referralPoints;
                    const newReferrals = (referrerData.referrals || 0) + 1;
                    const newMonthlyReferrals = ((referrerData.lastReferralMonth === currentMonth) ? 
                        (referrerData.monthlyReferrals || 0) : 0) + 1;
                    
                    // Update referrer's data
                    await database.ref(`users/${referrerId}`).update({
                        points: newReferrerPoints,
                        referrals: newReferrals,
                        monthlyReferrals: newMonthlyReferrals,
                        lastReferralMonth: currentMonth,
                        referralPoints: (referrerData.referralPoints || 0) + referralPoints
                    });
                    
                    // Update current user's data
                    await database.ref(`users/${currentUser.uid}`).update({
                        referralRewarded: true
                    });
                    
                    // Update local userData if referrer is current user
                    if (referrerId === currentUser.uid && userData) {
                        userData.points = newReferrerPoints;
                        userData.referrals = newReferrals;
                        userData.referralPoints = (userData.referralPoints || 0) + referralPoints;
                        updateUI();
                        showToast(`üéâ +${referralPoints} points from referral!`);
                    }
                }
            } catch (error) {
                console.error('Error checking referral rewards:', error);
            }
        }

        // Update Rewards Section
        function updateRewardsSection() {
            if (!userData) return;
            
            const progressDays = userData.activeDays || 0;
            const progressPercent = Math.min(100, (progressDays / 30) * 100);
            
            document.getElementById('progress-days').textContent = progressDays;
            document.getElementById('progress-percent').textContent = `${Math.round(progressPercent)}%`;
            document.getElementById('progress-fill').style.width = `${progressPercent}%`;
            
            const statusElement = document.getElementById('reward-status');
            const messageElement = document.getElementById('reward-message');
            const formElement = document.getElementById('reward-form');
            
            let statusClass = '';
            let message = '';
            
            switch (userData.rewardStatus) {
                case 'NOT_ELIGIBLE':
                    if (progressDays < 30) {
                        statusClass = 'status-not-eligible';
                        message = `Complete ${30 - progressDays} more days to become eligible`;
                    } else {
                        statusClass = 'status-eligible';
                        message = 'üéâ You are eligible for reward!';
                        formElement.style.display = 'block';
                    }
                    break;
                    
                case 'PENDING':
                    statusClass = 'status-pending';
                    const requestDate = new Date(userData.rewardRequestDate);
                    const deliveryDate = new Date(requestDate);
                    deliveryDate.setDate(deliveryDate.getDate() + 3);
                    message = `Reward processing - Will be sent by ${deliveryDate.toLocaleDateString()}`;
                    formElement.style.display = 'none';
                    break;
                    
                case 'COMPLETED':
                    statusClass = 'status-completed';
                    message = `üéâ Reward sent to ${userData.upi || 'your UPI ID'}`;
                    formElement.style.display = 'none';
                    break;
            }
            
            statusElement.className = `reward-status ${statusClass}`;
            messageElement.textContent = message;
        }

        // Handle Reward Request
        async function handleRewardRequest() {
            const upiId = document.getElementById('upi-id').value;
            
            if (!upiId) {
                showToast('Please enter your UPI ID');
                return;
            }
            
            // Simple UPI validation
            if (!upiId.includes('@')) {
                showToast('Please enter a valid UPI ID (e.g., name@upi)');
                return;
            }
            
            if (!currentUser || !userData) return;
            
            // Check if eligible
            if (userData.activeDays < 30) {
                showToast('You need 30 active days to request reward');
                return;
            }
            
            // Check if already requested
            if (userData.rewardStatus === 'PENDING' || userData.rewardStatus === 'COMPLETED') {
                showToast('You have already requested or received your reward');
                return;
            }
            
            try {
                const button = document.getElementById('request-reward-btn');
                button.disabled = true;
                button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
                
                // Update user data
                const updates = {
                    rewardStatus: 'PENDING',
                    rewardRequestDate: new Date().toISOString(),
                    upi: upiId
                };
                
                await database.ref(`users/${currentUser.uid}`).update(updates);
                
                // Update local userData
                Object.assign(userData, updates);
                
                // Update UI
                updateUI();
                
                showToast('‚úÖ Reward request submitted! Will be sent within 3 days.');
                
            } catch (error) {
                console.error('Error submitting reward request:', error);
                showToast('Error submitting request. Please try again.');
            }
        }

        // Copy Referral Code
        function copyReferralCode() {
            const referralCode = document.getElementById('referral-code').textContent;
            if (referralCode && referralCode !== 'Loading...') {
                navigator.clipboard.writeText(referralCode).then(() => {
                    showToast('üìã Referral code copied to clipboard!');
                });
            }
        }

        // Switch Section
        function switchSection(sectionId) {
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.toggle('active', item.dataset.section === sectionId);
            });
            
            // Update sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.toggle('active', section.id === `${sectionId}-section`);
            });
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        // Show Screen
        function showScreen(screenName) {
            Object.keys(screens).forEach(key => {
                screens[key].classList.toggle('active', key === screenName);
            });
        }

        // Show Toast
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('active');
            
            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }

        // Handle Referral Signup
        async function handleReferralSignup(referralCode, newUserId) {
            try {
                // Find user with this referral code
                const usersSnapshot = await database.ref('users').once('value');
                let referrerId = null;
                
                usersSnapshot.forEach((childSnapshot) => {
                    const user = childSnapshot.val();
                    if (user.referralCode === referralCode) {
                        referrerId = childSnapshot.key;
                    }
                });
                
                if (!referrerId) return;
                
                // Update new user's referredBy field
                await database.ref(`users/${newUserId}/referredBy`).set(referralCode);
                
            } catch (error) {
                console.error('Error handling referral signup:', error);
            }
        }

        // Generate Random Code
        function generateRandomCode(length) {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            
            for (let i = 0; i < length; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            return code;
        }

        // Get Reward Status Text
        function getRewardStatusText(status) {
            switch (status) {
                case 'NOT_ELIGIBLE': return 'Not Eligible';
                case 'PENDING': return 'Processing';
                case 'COMPLETED': return 'Completed';
                default: return 'Not Eligible';
            }
        }

        // Get Error Message
        function getErrorMessage(error) {
            switch (error.code) {
                case 'auth/email-already-in-use':
                    return 'Email already registered';
                case 'auth/invalid-email':
                    return 'Invalid email address';
                case 'auth/weak-password':
                    return 'Password is too weak';
                case 'auth/wrong-password':
                    return 'Incorrect password';
                case 'auth/user-not-found':
                    return 'User not found';
                default:
                    return error.message;
            }
        }

        // Reset Daily Timer
        function resetDailyTimer() {
            if (confirm('Reset timer? This will restart the 2-minute wait period.')) {
                stopTimer();
                timeLeft = 120;
                updateTimerDisplay();
                updateCheckinButton(false);
                startVisitTimer();
                showToast('Timer reset successfully!');
            }
        }

        // Check Daily Check-in
        function checkDailyCheckin() {
            if (!userData || !userData.lastCheckIn) {
                return;
            }
            
            const lastCheckIn = new Date(userData.lastCheckIn);
            const today = new Date();
            
            // Check if already checked in today
            if (lastCheckIn.toDateString() === today.toDateString()) {
                updateCheckinButton(true);
            }
        }
    </script>
</body>
</html>
